[nlp_alert_analysis]
search = index=your_search_index | head 100 | nlp_analyze field=search | where nlp_similarity_score > 0.7 | table _time, search, nlp_most_similar_term, nlp_similarity_score, nlp_sentiment_label, nlp_sentiment_score
description = Analyze search queries using NLP and find suspicious terms
cron_schedule = */5 * * * *
action.webhook = 1
action.webhook.param.url = http://your-docker-host:5000/splunk_webhook
action.webhook.param.method = POST
action.webhook.param.payload = {"result": $result$}
disabled = 0

[high_similarity_alerts]
search = index=nlp_alerts | where nlp_similarity_score > 0.8 | sort - nlp_similarity_score | head 20
description = Show alerts with high similarity to sensitive terms
cron_schedule = */1 * * * *
disabled = 0

[sentiment_analysis_dashboard]
search = index=nlp_alerts | stats count by nlp_sentiment_label | sort - count
description = Sentiment analysis summary
cron_schedule = */10 * * * *
disabled = 0
